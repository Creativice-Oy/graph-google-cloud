// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`#fetchKmsCryptoKeys should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-01-13T15:04:41.021576736Z",
            "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1610550281021,
      "displayName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring",
      "projectId": "j1-gc-integration-dev-300716",
      "shortName": "j1-gc-integration-dev-300716-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1-gc-integration-dev-300716-bucket-ring/key?project=j1-gc-integration-dev-300716",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-01-29T14:15:10.070214831Z",
            "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1611929710070,
      "displayName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring",
      "projectId": "j1-gc-integration-dev-300716",
      "shortName": "j1-gc-integration-dev-300716-new-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1-gc-integration-dev-300716-new-bucket-ring/key?project=j1-gc-integration-dev-300716",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-01-13T15:04:43.144108291Z",
            "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
            "nextRotationTime": "2021-02-03T15:05:05.514725Z",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2021-02-02T15:05:04.514725387Z",
              "generateTime": "2021-02-02T15:05:04.514725387Z",
              "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key/cryptoKeyVersions/21",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "rotationPeriod": "86401s",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1610550283144,
      "displayName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
      "nextRotationTime": 1612364705514,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1612278304514,
      "primaryGenerateTime": 1612278304514,
      "primaryName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key/cryptoKeyVersions/21",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": 86401,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us/j1-gc-integration-dev-300716-bucket-ring/projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key?project=j1-gc-integration-dev-300716",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-01-29T14:15:12.093490413Z",
            "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
            "nextRotationTime": "2021-02-04T14:15:17.881088Z",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2021-02-03T14:15:16.881088644Z",
              "generateTime": "2021-02-03T14:15:16.881088644Z",
              "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key/cryptoKeyVersions/6",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "rotationPeriod": "86401s",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1611929712093,
      "displayName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
      "nextRotationTime": 1612448117881,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1612361716881,
      "primaryGenerateTime": 1612361716881,
      "primaryName": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key/cryptoKeyVersions/6",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": true,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": 86401,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us/j1-gc-integration-dev-300716-new-bucket-ring/projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key?project=j1-gc-integration-dev-300716",
    },
  ],
  "collectedRelationships": Array [
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring",
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring|has|projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-bucket-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring",
      "_key": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring|has|projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-300716/locations/us/keyRings/j1-gc-integration-dev-300716-new-bucket-ring/cryptoKeys/j1-gc-integration-dev-300716-new-bucket-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
  ],
  "encounteredTypes": Array [
    "google_kms_key_ring",
    "google_kms_crypto_key",
    "google_kms_key_ring_has_crypto_key",
  ],
  "numCollectedEntities": 4,
  "numCollectedRelationships": 2,
}
`;

exports[`#fetchKmsKeyRings should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev/locations/us/keyRings/j1-gc-integration-dev-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2020-07-28T18:34:26.034565002Z",
            "name": "projects/j1-gc-integration-dev/locations/us/keyRings/j1-gc-integration-dev-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1595961266034,
      "displayName": "projects/j1-gc-integration-dev/locations/us/keyRings/j1-gc-integration-dev-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev/locations/us/keyRings/j1-gc-integration-dev-bucket-ring",
      "projectId": "j1-gc-integration-dev",
      "shortName": "j1-gc-integration-dev-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1-gc-integration-dev-bucket-ring/key?project=j1-gc-integration-dev",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev/locations/us/keyRings/j1dev-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2020-07-28T18:30:53.453045041Z",
            "name": "projects/j1-gc-integration-dev/locations/us/keyRings/j1dev-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1595961053453,
      "displayName": "projects/j1-gc-integration-dev/locations/us/keyRings/j1dev-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev/locations/us/keyRings/j1dev-bucket-ring",
      "projectId": "j1-gc-integration-dev",
      "shortName": "j1dev-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1dev-bucket-ring/key?project=j1-gc-integration-dev",
    },
  ],
  "collectedRelationships": Array [],
  "encounteredTypes": Array [
    "google_kms_key_ring",
  ],
  "numCollectedEntities": 2,
  "numCollectedRelationships": 0,
}
`;
